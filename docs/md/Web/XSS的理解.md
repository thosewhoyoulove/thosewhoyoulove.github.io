
# XSS 介绍

XSS（Cross Site Scripting，跨站脚本攻击）是一种安全漏洞，允许攻击者向网站注入恶意客户端代码。该代码由受害者执行从而让攻击者绕过访问控制并冒充用户。

如果 Web 应用程序没有充足的校验或加密，这些攻击就会成功。用户的浏览器无法检测到恶意脚本是否不可信，因此会授予其访问任何 cookie、会话令牌或其他敏感站点特定信息的权限，或者让恶意脚本重写 HTML 内容。

## 发生情况

1. 数据通过不受信任的来源（通常是 Web 请求）进入 Web 应用程序
2. 动态内容未经恶意内容验证就发送给 Web 用户。

恶意内容通常包括 JavaScript，但有时也包括 HTML、Flash 或浏览器可以执行的任何其他代码。基于 XSS 的攻击种类几乎是无限的，但它们通常包括向攻击者传输 Cookie 等隐私数据或其他会话信息、将受害者重定向到攻击者控制的网页，或者以易受攻击的站点为幌子在用户的计算机上执行其他恶意操作。

## XSS 攻击类型

- 存储型 XSS 攻击：注入的脚本永久存储在目标服务器上。当浏览器发送数据请求时，受害者会从服务器接收到该恶意脚本。

- 反射型 XSS 攻击：攻击者将恶意脚本代码注入到 URL 中，当用户访问包含该恶意代码的 URL 时，恶意代码会被执行。

- DOM 型 XSS 攻击：攻击者将恶意脚本代码注入到页面的 DOM 中，当用户浏览该页面时，恶意代码会被执行。

## 防范 XSS 攻击的主要方法包括

- 对用户输入进行过滤和验证，特别是对用户输入的特殊字符（如 <、>、'、" 等）进行转义或过滤，避免注入恶意代码。

- 使用 CSP（Content Security Policy）策略，限制页面中可以执行的脚本，从而防止恶意脚本的执行。

- 在 cookie 中设置 HttpOnly 属性，避免 cookie 被 JavaScript 访问，从而防止 cookie 盗取攻击。

- 在页面中使用 HTTPS 协议，避免数据在传输过程中被窃取或篡改。

- 对于存储型 XSS 攻击，可以使用输入过滤和输出过滤来限制恶意脚本的注入和执行。输入过滤可以使用 HTML Purifier 等工具来实现，输出过滤可以使用htmlspecialchars 等函数来实现。
